<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot Interface</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f3f4f6;
        }

        #chatContainer {
            position: fixed;
            bottom: 0px;
            right: 0px;
            width: 100%;
            height: 100%;
            background: #ffffff;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: all 0.3s ease-in-out;
        }

        #header {
            background: linear-gradient(90deg, #16a085, #1abc9c);
            color: #ffffff;
            padding: 12px;
            text-align: center;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            border-bottom: 1px solid #dddddd;
        }

        #messages {
            height: 350px;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            background: #f9fafb;
        }

        .message {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            max-width: 80%;
        }

        .bot {
            flex-direction: row;
        }

        .user {
            align-self: flex-end;
            flex-direction: row-reverse;
            color: white;
        }

        .bot img {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: 2px solid #1abc9c;
        }

        .text {
            padding: 10px;
            border-radius: 20px;
            background: #e9ecef;
            color: #333;
            word-wrap: break-word;
            white-space: pre-wrap;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            font-size: 14px;
        }

        .user .text {
            background: #16a085;
            color: white;
            border-radius: 20px 20px 5px 20px;
        }

        #inputBox {
            display: flex;
            padding: 12px;
            gap: 10px;
            border-top: 1px solid #ddd;
            background: #f9fafb;
        }

        #userInput {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            background: #ffffff;
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
            transition: border-color 0.2s;
        }

        #userInput:focus {
            outline: none;
            border-color: #1abc9c;
        }

        #sendButton {
            padding: 10px 15px;
            border: none;
            background: #16a085;
            color: white;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: background 0.3s;
        }

        #sendButton:hover {
            background: #1abc9c;
        }

        /* Custom scrollbar styling */
        #messages::-webkit-scrollbar {
            width: 8px;
        }

        #messages::-webkit-scrollbar-thumb {
            background: #cccccc;
            border-radius: 4px;
        }

        #messages::-webkit-scrollbar-thumb:hover {
            background: #aaaaaa;
        }

        #messages::-webkit-scrollbar-track {
            background: #f0f0f0;
        }
    </style>

</head>

<body>
    <div id="chatContainer">
        <div id="header">Chatbot</div>
        <div id="messages"></div>
        <div id="inputBox">
            <input type="text" id="userInput" placeholder="Enter a message...">
            <button id="sendButton" onclick="sendMessage()">Send</button>
        </div>
    </div>

    <script>
        const messagesDiv = document.getElementById('messages');

        async function sendMessage() {
            const userInput = document.getElementById('userInput').value.trim();
            if (!userInput) return;

            // Hiển thị tin nhắn người dùng
            appendMessage('user', userInput);

            // Kiểm tra câu hỏi đặc biệt
            if (userInput.toLowerCase() === "làm sao để cây của tôi ra hoa nhanh hơn?") {
                const specialResponse = `🌼 1. Điều chỉnh chế độ ánh sáng
Cây cần đủ ánh sáng, đặc biệt là ánh nắng trực tiếp vào buổi sáng sớm.

Nếu trồng trong nhà, nên thường xuyên xoay hướng cây hoặc mang ra nơi thoáng sáng vài tiếng mỗi ngày.

🌿 2. Hạn chế tưới nước tạm thời (stress nhẹ)
Giai đoạn trước khi cây ra hoa, bạn có thể giảm lượng nước tưới trong 5–7 ngày để tạo "stress nhẹ" giúp kích thích cơ chế ra hoa.

Tuy nhiên, tránh để cây bị héo úa hoàn toàn.

🧪 3. Cắt tỉa đúng cách
Cắt bỏ các lá già, cành yếu hoặc cành đã ra hoa trước đó để kích thích mầm hoa mới phát triển.

🧫 4. Bổ sung chất điều hòa sinh trưởng
Một số cây cần đến chất điều hòa sinh trưởng tự nhiên như Cytokinin hoặc Gibberellin để phân hóa mầm hoa.

Nên dùng kết hợp với phân bón kích hoa chuyên dụng để đạt hiệu quả cao.

🍂 5. Dinh dưỡng – yếu tố quyết định
Cây muốn ra hoa cần lượng lân (P) và kali (K) cao, trong khi giảm đạm 👎 để tránh phát triển lá quá mức.

Tăng cường vi lượng Bo, Zn, Mg để giúp hoa bền màu, không rụng nụ.

✅ Gợi ý sản phẩm chuyên dụng
Để đơn giản hóa quy trình chăm sóc mà vẫn đạt hiệu quả cao, bạn nên sử dụng Siêu Kích Hoa của Lục Sinh – sản phẩm phân bón hữu cơ vi sinh chuyên dụng giúp:

Kích thích mầm hoa phát triển đồng loạt, hoa nở to và màu sắc tươi sáng.

Giàu lân – kali – Bo – Zn giúp cây chuyển giai đoạn sinh trưởng nhanh chóng.

An toàn với môi trường và người sử dụng, đặc biệt phù hợp với cây trồng tại nhà, ban công, sân vườn nhỏ.

Không mùi, dễ sử dụng – chỉ cần pha loãng và tưới gốc hoặc phun sương lên lá.
                `;
                appendMessageWithAnimation('bot', specialResponse);
                document.getElementById('userInput').value = '';
                return;
            }

            if (userInput.toLowerCase() === "cách trồng hoa giấy hiệu quả?") {
                const specialResponse = `🌺 **Chọn vị trí trồng**:
Đặt cây nơi có ít nhất 6–8 giờ ánh sáng mặt trời trực tiếp mỗi ngày.
Hoa giấy rất ưa sáng, thiếu nắng sẽ khó ra hoa đẹp.

🌱 **Chuẩn bị đất trồng**:
Sử dụng đất tơi xốp, thoát nước tốt, giàu mùn và hữu cơ.
Có thể trộn thêm phân hữu cơ hoặc tro trấu, xơ dừa để tăng độ thoáng khí.

🛠️ **Kỹ thuật trồng**:
Đào hố lớn hơn bầu cây, đặt nhẹ nhàng cây vào hố, lấp đất và nén chặt gốc.
Tưới nước nhẹ sau khi trồng để cố định bầu đất, nhưng tránh tưới đẫm.

💧 **Chăm sóc ban đầu**:
Hạn chế tưới nước thường xuyên trong 1–2 tuần đầu để kích thích rễ phát triển tìm nước.
Khi rễ đã ổn định, duy trì tưới định kỳ 2–3 lần/tuần tùy theo thời tiết.

🌿 **Bón phân**:
Sau khi cây bén rễ, bón phân định kỳ để thúc đẩy sinh trưởng và ra hoa.

✅ **Khuyến nghị sản phẩm từ Lục Sinh**:
- **Siêu Kích Rễ Lục Sinh**:
    - Là phân bón hữu cơ vi sinh chuyên dụng cho giai đoạn sau trồng.
    - Giúp bộ rễ hoa giấy phát triển nhanh, khỏe mạnh, tăng khả năng hút nước và dinh dưỡng.
    - Giúp cây sớm phục hồi sau khi trồng và chuẩn bị nền tảng cho ra hoa.
- **Siêu Kích Hoa Lục Sinh**:
    - Là sản phẩm chuyên biệt giúp kích thích cây phân hóa mầm hoa mạnh mẽ.
    - Tăng tỷ lệ đậu hoa, giúp hoa giấy nở rực rỡ, bền màu, đồng loạt.
    - Giàu lân, kali, và vi lượng Bo, Zn – những dưỡng chất thiết yếu cho giai đoạn ra hoa.`;

                appendMessageWithAnimation('bot', specialResponse);
                document.getElementById('userInput').value = '';
                return;
            }

            // Nếu không phải câu hỏi đặc biệt, gửi yêu cầu đến API
            try {
                const response = await fetch(
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=AIzaSyBuVKfuCZlneeZf8kAgICsYBVdZAxMwvis`,
                    {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [
                                {
                                    parts: [{ text: userInput }]
                                }
                            ]
                        }),
                    }
                );

                if (!response.ok) {
                    console.error(`Error: ${response.status} - ${response.statusText}`);
                    appendMessage('bot', `Error: ${response.status} - ${response.statusText}`);
                    return;
                }

                const data = await response.json();
                console.log("Full API Response:", data);

                const botResponse = data.candidates[0].content.parts[0].text;
                appendMessageWithAnimation('bot', botResponse);

            } catch (error) {
                console.error("Error connecting to API:", error.message);
                appendMessage('bot', `Error: Unable to connect to API. (${error.message})`);
            }

            document.getElementById('userInput').value = '';
        }

        function appendMessage(sender, text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;

            if (sender === 'bot') {
                const icon = document.createElement('img');
                icon.src = './image/chatbot.png'; // Đường dẫn đến icon chatbot
                icon.alt = 'Chatbot Icon';
                messageDiv.appendChild(icon);
            }

            const textDiv = document.createElement('div');
            textDiv.className = 'text';
            textDiv.textContent = text;
            messageDiv.appendChild(textDiv);

            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        function appendMessageWithAnimation(sender, text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;

            if (sender === 'bot') {
                const icon = document.createElement('img');
                icon.src = './image/chatbot.png'; // Đường dẫn đến icon chatbot
                icon.alt = 'Chatbot Icon';
                messageDiv.appendChild(icon);
            }

            const textDiv = document.createElement('div');
            textDiv.className = 'text';
            messageDiv.appendChild(textDiv);

            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;

            let index = 0;
            const interval = setInterval(() => {
                if (index < text.length) {
                    textDiv.textContent += text[index];
                    index++;
                } else {
                    clearInterval(interval);
                }
            }, 5);
        }

        document.getElementById("userInput").addEventListener("keydown", function (event) {
            if (event.key === "Enter") {
                sendMessage();
            }
        });
    </script>
</body>

</html>